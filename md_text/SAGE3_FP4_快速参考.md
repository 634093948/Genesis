# Sage3 FP4 å¿«é€Ÿå‚è€ƒå¡ç‰‡

## âœ… ä¿®å¤çŠ¶æ€

**é—®é¢˜**: æ— æ³•è¯†åˆ«å’Œè°ƒç”¨ sage fp4  
**çŠ¶æ€**: âœ… å·²ä¿®å¤  
**æµ‹è¯•**: âœ… é€šè¿‡  

---

## ğŸš€ å¿«é€Ÿä½¿ç”¨

### 1. éªŒè¯å®‰è£…
```bash
python313\python.exe test_sage3_fp4.py
```

### 2. å¯åŠ¨ UI
```bash
start.bat
```

### 3. é…ç½®å‚æ•°
**Model Settings æ ‡ç­¾é¡µ**:
- **Attention Mode**: `sageattn_3_fp4` â­
- **Quantization**: `fp4_scaled`

---

## ğŸ“Š Attention Mode é€‰æ‹©æŒ‡å—

| æ¨¡å¼ | é€Ÿåº¦ | æ˜¾å­˜ | è´¨é‡ | æ¨èåœºæ™¯ |
|------|------|------|------|----------|
| **sageattn_3_fp4** âš¡ | æœ€å¿« | æœ€ä½ | è‰¯å¥½ | ä½æ˜¾å­˜/å¿«é€Ÿé¢„è§ˆ |
| **sageattn_3_fp8** | å¾ˆå¿« | ä½ | å¾ˆå¥½ | å¹³è¡¡æ–¹æ¡ˆ |
| **sageattn_3** | å¿« | ä¸­ | ä¼˜ç§€ | é«˜è´¨é‡ç”Ÿæˆ |
| **sageattn** | å¿« | ä¸­ | å¾ˆå¥½ | é€šç”¨åœºæ™¯ |
| **flash_attn** | å¿« | ä¸­ | ä¼˜ç§€ | é•¿åºåˆ— |
| **sdpa** | ä¸­ | ä¸­ | ä¼˜ç§€ | å…¼å®¹æ€§æœ€å¥½ |

---

## ğŸ¯ æ¨èé…ç½®

### ä½æ˜¾å­˜ (8-12GB) ğŸ’¾
```
Attention: sageattn_3_fp4
Quantization: fp4_scaled
Block Swap: 16-20 blocks
Steps: 4
Resolution: 1280x720
Frames: 61
```

### å¹³è¡¡ (12-16GB) âš–ï¸
```
Attention: sageattn_3_fp8
Quantization: fp8_scaled
Block Swap: 8-12 blocks
Steps: 20-30
Resolution: 1280x720
Frames: 81
```

### é«˜è´¨é‡ (16GB+) ğŸ¨
```
Attention: sageattn_3 / flash_attn
Quantization: fp8_scaled
Block Swap: Disabled
Steps: 30-50
Resolution: 1920x1080
Frames: 121
```

---

## ğŸ”§ ä¿®å¤å†…å®¹

### æ–‡ä»¶ä¿®æ”¹
1. âœï¸ `attention.py` - ä¿®å¤ sage3 å¯¼å…¥é€»è¾‘
2. âœï¸ `wanvideo_gradio_app.py` - æ·»åŠ  FP4 UI é€‰é¡¹

### æ–°å¢æ–‡ä»¶
1. â• `test_sage3_fp4.py` - æµ‹è¯•è„šæœ¬
2. â• `SAGE3_FP4_ä½¿ç”¨è¯´æ˜.md` - è¯¦ç»†æ–‡æ¡£
3. â• `SAGE3_FP4_ä¿®å¤æ€»ç»“.md` - æŠ€æœ¯æ€»ç»“

---

## ğŸ“ˆ æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | BF16 | FP8 | FP4 |
|------|------|-----|-----|
| æ˜¾å­˜å ç”¨ | 100% | 50% | 25% |
| è®¡ç®—é€Ÿåº¦ | 1x | 1.5-2x | 2-3x |
| ç²¾åº¦æŸå¤± | 0% | <1% | 1-3% |

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### FP4 é€‚ç”¨æ¡ä»¶
- âœ… GPU: NVIDIA Blackwell æ¶æ„ (RTX 50 ç³»åˆ—)
- âœ… Head Dim: < 256
- âœ… æ•°æ®ç±»å‹: BF16/FP16

### è‡ªåŠ¨å›é€€
å¦‚æœ FP4 ä¸å¯ç”¨,ä¼šè‡ªåŠ¨å›é€€åˆ°:
1. SageAttention3 (é»˜è®¤ç²¾åº¦)
2. SageAttention (INT8)
3. PyTorch SDPA

---

## ğŸ› æ•…éšœæ’é™¤

### é—®é¢˜: ä»ä½¿ç”¨å…¶ä»–æ¨¡å¼
**æŸ¥çœ‹**: æ§åˆ¶å°æ—¥å¿—ä¸­çš„è­¦å‘Šä¿¡æ¯  
**éªŒè¯**: è¿è¡Œ `test_sage3_fp4.py`  
**ç¡®è®¤**: GPU å‹å·æ˜¯å¦æ”¯æŒ

### é—®é¢˜: è´¨é‡ä¸‹é™
**æ–¹æ¡ˆ 1**: ä½¿ç”¨ `sageattn_3_fp8` ä»£æ›¿  
**æ–¹æ¡ˆ 2**: å¢åŠ ç”Ÿæˆæ­¥æ•°  
**æ–¹æ¡ˆ 3**: è°ƒæ•´ CFG scale

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- ğŸ“– **è¯¦ç»†è¯´æ˜**: `SAGE3_FP4_ä½¿ç”¨è¯´æ˜.md`
- ğŸ“ **æŠ€æœ¯æ€»ç»“**: `SAGE3_FP4_ä¿®å¤æ€»ç»“.md`
- ğŸ§ª **æµ‹è¯•è„šæœ¬**: `test_sage3_fp4.py`

---

## âœ¨ æ ¸å¿ƒä¼˜åŠ¿

1. ğŸš€ **æ€§èƒ½æå‡**: 2-3å€é€Ÿåº¦æå‡
2. ğŸ’¾ **æ˜¾å­˜èŠ‚çœ**: èŠ‚çœ 75% æ˜¾å­˜
3. ğŸ¯ **æ˜“äºä½¿ç”¨**: UI ç›´æ¥é€‰æ‹©
4. ğŸ”„ **è‡ªåŠ¨å›é€€**: ä¿è¯ç¨³å®šæ€§
5. ğŸ“Š **çµæ´»é…ç½®**: å¤šç§æ¨¡å¼é€‰æ‹©

---

**ä¿®å¤å®Œæˆ**: 2025-01-17  
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª  
**ç‰ˆæœ¬**: sage3 3.0.0
